#!/bin/bash

source build/rc;

dist="$(get-dist)" || exit 1;

if [ ! -f "$dist" -o "$1" == -f ]; then
    ./build/build "$@" || exit $?;
fi

dist="$(get-dist)" || exit 1;
install_log="$(cpanm "$dist" 2>&1)";
errno=$?;

if [ $errno != 0 ]; then
    echo -n "$install_log" 1>&2;
    exit 1;
fi;

echo "Installing $dist... done.";
